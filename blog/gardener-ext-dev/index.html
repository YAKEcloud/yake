<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">Getting started with Gardener extension development | Yet another Kubernetes Engine</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://yake.cloud/blog/gardener-ext-dev"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" name="gardener" content="installation, production, operations, maintenance"><meta data-rh="true" property="og:title" content="Getting started with Gardener extension development | Yet another Kubernetes Engine"><meta data-rh="true" name="description" content="TLDR;"><meta data-rh="true" property="og:description" content="TLDR;"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2022-06-08T00:00:00.000Z"><meta data-rh="true" property="article:author" content="https://github.com/jensac"><meta data-rh="true" property="article:tag" content="gardener,gardener-extensions"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://yake.cloud/blog/gardener-ext-dev"><link data-rh="true" rel="alternate" href="https://yake.cloud/blog/gardener-ext-dev" hreflang="en"><link data-rh="true" rel="alternate" href="https://yake.cloud/blog/gardener-ext-dev" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","@id":"https://yake.cloud/blog/gardener-ext-dev","mainEntityOfPage":"https://yake.cloud/blog/gardener-ext-dev","url":"https://yake.cloud/blog/gardener-ext-dev","headline":"Getting started with Gardener extension development","name":"Getting started with Gardener extension development","description":"TLDR;","datePublished":"2022-06-08T00:00:00.000Z","author":{"@type":"Person","name":"Jens Schneider","description":"software engineer","url":"https://github.com/jensac","image":"https://github.com/jensac.png"},"keywords":[],"isPartOf":{"@type":"Blog","@id":"https://yake.cloud/blog","name":"Blog"}}</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Yet another Kubernetes Engine RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Yet another Kubernetes Engine Atom Feed"><link rel="stylesheet" href="/assets/css/styles.9a630ee0.css">
<script src="/assets/js/runtime~main.92817b59.js" defer="defer"></script>
<script src="/assets/js/main.4756c9e9.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/img/logo.svg"><link rel="preload" as="image" href="/img/logo_dark.svg"><link rel="preload" as="image" href="https://github.com/jensac.png"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="YAKE" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo_dark.svg" alt="YAKE" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">YAKE</b></a><a class="navbar__item navbar__link" href="/docs/overview">Docs</a><a class="navbar__item navbar__link" href="/release-notes/v1.128">Release Notes</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Blog</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/docs/overview">1.128.x</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/next/overview">Next</a></li><li><a class="dropdown__link" href="/docs/overview">1.128.x</a></li><li><a class="dropdown__link" href="/docs/1.127.x/overview">1.127.x</a></li><li><a class="dropdown__link" href="/docs/1.126.x/overview">1.126.x</a></li><li><a class="dropdown__link" href="/docs/1.125.x/overview">1.125.x</a></li><li><a class="dropdown__link" href="/docs/1.124.x/overview">1.124.x</a></li><li><a class="dropdown__link" href="/docs/1.123.x/overview">1.123.x</a></li><li><a class="dropdown__link" href="/docs/1.122.x/overview">1.122.x</a></li><li><a class="dropdown__link" href="/docs/1.121.x/overview">1.121.x</a></li><li><a class="dropdown__link" href="/docs/1.120.x/overview">1.120.x</a></li><li><a class="dropdown__link" href="/docs/1.119.x/overview">1.119.x</a></li><li><a class="dropdown__link" href="/docs/1.118.x/overview">1.118.x</a></li><li><a class="dropdown__link" href="/docs/1.117.x/overview">1.117.x</a></li><li><a class="dropdown__link" href="/docs/1.116.x/overview">1.116.x</a></li><li><a class="dropdown__link" href="/docs/1.115.x/overview">1.115.x</a></li><li><a class="dropdown__link" href="/docs/1.114.x/overview">1.114.x</a></li><li><a class="dropdown__link" href="/docs/1.113.x/overview">1.113.x</a></li><li><a class="dropdown__link" href="/docs/1.112.x/overview">1.112.x</a></li><li><a class="dropdown__link" href="/docs/1.111.x/overview">1.111.x</a></li><li><a class="dropdown__link" href="/docs/1.110.x/overview">1.110.x</a></li><li><a class="dropdown__link" href="/docs/1.109.x/overview">1.109.x</a></li><li><a class="dropdown__link" href="/docs/1.108.x/overview">1.108.x</a></li><li><a class="dropdown__link" href="/docs/1.107.x/overview">1.107.x</a></li><li><a class="dropdown__link" href="/docs/1.106.x/overview">1.106.x</a></li><li><a class="dropdown__link" href="/docs/1.105.x/overview">1.105.x</a></li><li><a class="dropdown__link" href="/docs/1.104.x/overview">1.104.x</a></li><li><a class="dropdown__link" href="/docs/1.103.x/overview">1.103.x</a></li><li><a class="dropdown__link" href="/docs/1.102.x/overview">1.102.x</a></li><li><a class="dropdown__link" href="/docs/1.101.x/overview">1.101.x</a></li><li><a class="dropdown__link" href="/docs/1.100.x/overview">1.100.x</a></li><li><a class="dropdown__link" href="/docs/1.99.x/overview">1.99.x</a></li><li><a class="dropdown__link" href="/docs/1.98.x/overview">1.98.x</a></li><li><a class="dropdown__link" href="/docs/1.97.x/overview">1.97.x</a></li><li><a class="dropdown__link" href="/docs/1.96.x/overview">1.96.x</a></li><li><a class="dropdown__link" href="/docs/1.95.x/overview">1.95.x</a></li><li><a class="dropdown__link" href="/docs/1.94.x/overview">1.94.x</a></li><li><a class="dropdown__link" href="/docs/1.93.x/overview">1.93.x</a></li><li><a class="dropdown__link" href="/docs/1.92.x/overview">1.92.x</a></li><li><a class="dropdown__link" href="/docs/1.91.x/overview">1.91.x</a></li><li><a class="dropdown__link" href="/docs/1.90.x/overview">1.90.x</a></li><li><a class="dropdown__link" href="/docs/1.89.x/overview">1.89.x</a></li><li><a class="dropdown__link" href="/docs/1.88.x/overview">1.88.x</a></li><li><a class="dropdown__link" href="/docs/1.87.x/overview">1.87.x</a></li><li><a class="dropdown__link" href="/docs/1.86.x/overview">1.86.x</a></li><li><a class="dropdown__link" href="/docs/1.85.x/overview">1.85.x</a></li><li><a class="dropdown__link" href="/docs/1.84.x/overview">1.84.x</a></li><li><a class="dropdown__link" href="/docs/1.83.x/overview">1.83.x</a></li><li><a class="dropdown__link" href="/docs/1.82.x/overview">1.82.x</a></li><li><a class="dropdown__link" href="/docs/1.81.x/overview">1.81.x</a></li><li><a class="dropdown__link" href="/docs/1.80.x/overview">1.80.x</a></li><li><a class="dropdown__link" href="/docs/1.79.x/overview">1.79.x</a></li><li><a class="dropdown__link" href="/docs/1.78.x/overview">1.78.x</a></li><li><a class="dropdown__link" href="/docs/1.77.x/overview">1.77.x</a></li><li><a class="dropdown__link" href="/docs/1.76.x/overview">1.76.x</a></li><li><a class="dropdown__link" href="/docs/1.75.x/overview">1.75.x</a></li><li><a class="dropdown__link" href="/docs/1.74.x/overview">1.74.x</a></li><li><a class="dropdown__link" href="/docs/1.73.x/overview">1.73.x</a></li><li><a class="dropdown__link" href="/docs/1.72.x/overview">1.72.x</a></li><li><a class="dropdown__link" href="/docs/1.71.x/overview">1.71.x</a></li><li><a class="dropdown__link" href="/docs/1.70.x/overview">1.70.x</a></li><li><a class="dropdown__link" href="/docs/1.69.x/overview">1.69.x</a></li><li><a class="dropdown__link" href="/docs/1.68.x/overview">1.68.x</a></li><li><a class="dropdown__link" href="/docs/1.67.x/overview">1.67.x</a></li><li><a class="dropdown__link" href="/docs/1.66.x/overview">1.66.x</a></li><li><a class="dropdown__link" href="/docs/1.65.x/overview">1.65.x</a></li><li><a class="dropdown__link" href="/docs/1.64.x/overview">1.64.x</a></li><li><a class="dropdown__link" href="/docs/1.63.x/overview">1.63.x</a></li></ul></div><a href="https://github.com/yakecloud/yake" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search searchBarContainer_NW3z" dir="ltr"><input placeholder="Search" aria-label="Search" class="navbar__search-input searchInput_YFbd" value=""><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">Recent posts</div><div role="group"><h3 class="yearGroupHeading_rMGB">2023</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/Gardener Hackathon 2023">Gardener Hackathon - May 2023</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/build-cluster-with-caph">Build Cluster with CAPH - the challanges when installing 23KE</a></li></ul></div><div role="group"><h3 class="yearGroupHeading_rMGB">2022</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/hack-the-garden">Hack-The-Garden - the Remote Hackathon Experience</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/gardener-chart-releaser">A Single Point of Truth for Gardener Helm Charts</a></li><li class="sidebarItem__DBe"><a aria-current="page" class="sidebarItemLink_mo7H sidebarItemLinkActive_I1ZP" href="/blog/gardener-ext-dev">Getting started with Gardener extension development</a></li></ul></div></nav></aside><main class="col col--7"><article class=""><header><h1 class="title_f1Hy">Getting started with Gardener extension development</h1><div class="container_mt6G margin-vert--md"><time datetime="2022-06-08T00:00:00.000Z">June 8, 2022</time> · <!-- -->13 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/jensac" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo authorImage_XqGP" src="https://github.com/jensac.png" alt="Jens Schneider"></a><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><a href="https://github.com/jensac" target="_blank" rel="noopener noreferrer"><span class="authorName_yefp">Jens Schneider</span></a></div><small class="authorTitle_nd0D" title="software engineer">software engineer</small><div class="authorSocials_rSDt"></div></div></div></div></div></header><div id="__blog-post-container" class="markdown"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="tldr">TLDR;<a href="#tldr" class="hash-link" aria-label="Direct link to TLDR;" title="Direct link to TLDR;">​</a></h2>
<p>Recently, we developed the <a href="https://github.com/23technologies/gardener-extension-mwe" target="_blank" rel="noopener noreferrer">gardener-extension-mwe</a>, which serves as a minimal working example for Gardener extensions.
If you are only interested in the code, go and checkout the repository on github.
If you want to learn more, keep on reading.</p>
<p><strong>Table of Contents</strong></p>
<ul>
<li><a href="#tldr">TLDR;</a></li>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#basic-workflows">Basic workflows</a></li>
<li><a href="#the-mininal-working-example">The mininal working example</a>
<ul>
<li><a href="#rapid-prototyping-on-a-kubernetes-cluster-tested-with-version-1226">Rapid prototyping on a Kubernetes cluster (tested with version 1.22.6)</a></li>
<li><a href="#development-in-a-real-gardener-environment">Development in a real Gardener environment</a></li>
</ul>
</li>
<li><a href="#last-words">Last words</a></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="introduction">Introduction<a href="#introduction" class="hash-link" aria-label="Direct link to Introduction" title="Direct link to Introduction">​</a></h2>
<p>Starting the development of new <a href="https://gardener.cloud/" target="_blank" rel="noopener noreferrer">Gardener</a> extensions can be challenging.
As the <a href="https://gardener.cloud/docs/" target="_blank" rel="noopener noreferrer">Gardener documentation</a> is fairly complex and driven by the history of the project, getting into the overall concepts is not easy.
Moreover, code examples for Gardener extensions reside in separate Git repositories lacking documentation.
However, early in March 2022 the <a href="https://github.com/gardener/gardener-extension-shoot-networking-filter" target="_blank" rel="noopener noreferrer">gardener-extension-shoot-networking-filter</a> was published, which comes at a more beginner friendly level than the e.g. the cloud-provider extensions.
In particular, it extends <code>Shoot</code> clusters by the use of <a href="https://gardener.cloud/docs/gardener/concepts/resource-manager/#managedresource-controller" target="_blank" rel="noopener noreferrer">managed resources</a>, which might be more straight-forward than the interaction with a cloud service provider as performed by e.g. the <a href="https://github.com/gardener/gardener-extension-provider-aws" target="_blank" rel="noopener noreferrer">gardener-extension-provider-aws</a>.
Thus, <a href="https://github.com/gardener/gardener-extension-shoot-networking-filter" target="_blank" rel="noopener noreferrer">gardener-extension-shoot-networking-filter</a> provides a reasonable starting point for new developments, which target at automated deployments into <code>Shoot</code> clusters.</p>
<p>However, going beyond the identification of a starting point, it makes sense to take a closer look at the concepts for extension development.
In the <a href="https://github.com/gardener/gardener/tree/master/extensions" target="_blank" rel="noopener noreferrer">extension directory</a> of the Gardener Git repository, we find several Go-packages defining interfaces, which can be implemented by extension controllers.
Put simply, we can search for files matching <code>pkg/controller/*/actuator.go</code>, in order to find interfaces for controllers acting on the corresponding resources.
E.g., if our controller defines a (golang)-type -- called <code>actuator</code> -- implementing the interface defined in <code>pkg/controller/extension/actuator.go</code>, the controller will reconcile resources of type <code>*extensionsv1alpha1.Extension</code>.
Consequently, the controller will take care for all the steps we define in the <code>Reconcile</code> method of the <code>actuator</code>, when <code>Extension</code> resources are updated.
Of course, there might be more complex scenarios where reconciling <code>Extension</code> resources would be insufficient.
In these cases, other interfaces like e.g. defined in <code>pkg/controller/infrastructure/actuator.go</code> would need to be implemented.
However, these cases lie beyond the scope of this blog post.</p>
<p>Next, we will dive into some basic workflows for Gardener extension development.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="basic-workflows">Basic workflows<a href="#basic-workflows" class="hash-link" aria-label="Direct link to Basic workflows" title="Direct link to Basic workflows">​</a></h2>
<p>In software engineering, it is reasonable to develop on a local machine with a controllable toolchain.
As already mentioned above, Gardener extensions are implemented in <a href="https://go.dev/" target="_blank" rel="noopener noreferrer">Go</a>.
Therefore, let&#x27;s identify a few requirements for the development:</p>
<ul>
<li>An installation of Go</li>
<li>A text editor, which (optionally) supports <a href="https://pkg.go.dev/golang.org/x/tools/gopls" target="_blank" rel="noopener noreferrer">gopls</a></li>
<li>A Go debugger, which is most likely to be <a href="https://github.com/go-delve/delve" target="_blank" rel="noopener noreferrer">Delve</a></li>
<li>A Gardener development environment. This can be setup by
<ul>
<li><a href="https://gardener.cloud/docs/gardener/development/getting_started_locally/" target="_blank" rel="noopener noreferrer">Running Gardener locally</a> (also checkout <a href="https://github.com/gardener/gardener/issues/5548" target="_blank" rel="noopener noreferrer">#5548</a>, if you are running on Linux)</li>
<li>Setting up a development Gardener on some cloud infrastructure. This definitely comes closer to the real world scenario your extension will eventually live in.
The block diagram below depicts the overall setup including the requirements from above.</li>
</ul>
</li>
</ul>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">┌──────────────────────────────────────────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│    Development Computer                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├──────────────────────────────────────────────┤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ ┌──────────────────────────────────────────┐ │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ │             - Your toolchain             │ │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ └──────────────────────────────────────────┘ │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│     ┌────────────┐        ┌──────────────┐   │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│     │Kubeconfigs │        │Your code     │   │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│     └──┬──────┬──┘        └────────┬─────┘   │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│        │      │                    │         │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└────────┼──────┼────────────────────┼─────────┘</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         │      │                    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         │      │apply               │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  apply  │      │resources           │reconcile</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">resources│      │                    │resources</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         │      └──────────────────┐ │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         │                         │ │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         │                         │ │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         ▼                         ▼ ▼</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   ┌─────────────────┐       ┌─────────────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   │ Garden Cluster  │       │ Seed Cluster    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   ├─────────────────┤       ├─────────────────┤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   │- Project        │       │- Extension      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   │- Seed           │       │- Controller     │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   │- Shoot          │       │- ...            │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   │- ...            │       │                 │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   └─────────────────┘       └─────────────────┘</span><br></span></code></pre></div></div>
<p>As you can see, the code for the extension controller is running on your local development machine, and reconciles resources, such as <code>Extension</code> resources, in the <code>Seed</code> cluster.
Of course, you will not have dedicated clusters for the <code>Garden</code> cluster and <code>Seed</code> cluster, when running Gardener locally.
However, the overall buidling blocks stay conceptually the same.
Once these requirements are met, you are good to go for your first steps with Gardener extensions.
Wait! I have to setup an entire Gardener, if I want to rapidly prototype an extension controller?
Yes and No. Depending on your development/test case, it might be reasonable to &quot;fake&quot; a Gardener environment on a vanilla Kubernetes cluster. We will get to this development case below.
For rock solid testing, however, you most probably need a real world Gardener environment.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="the-mininal-working-example">The mininal working example<a href="#the-mininal-working-example" class="hash-link" aria-label="Direct link to The mininal working example" title="Direct link to The mininal working example">​</a></h2>
<p>As of May 2022, we provide a Minimal Working Example (MWE) for gardener extensions.
Of course, this example did not come out of nowhere.
Therefore, we review the development process and break the example down to its components in the following:
Taking a look at other extensions, it is observed that we need some boiler plate code for running our controller, so that it works together with all the other Gardener components.
For the MWE, we collected the relevant files and adjusted them to our needs.
Thus, we can have a look at the <code>cmd</code> directory of the <a href="https://github.com/23technologies/gardener-extension-mwe" target="_blank" rel="noopener noreferrer">gardener-extension-mwe</a> and find a simple structure with 3 files, which are responsible for starting our controller and ensuring that it acts on the defined resources.</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cmd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└── gardener-extension-mwe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ├── app</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    │   ├── app.go</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    │   └── options.go</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    └── main.go</span><br></span></code></pre></div></div>
<p>If you want to start the development of a new extension, you do not need to worry too much about these files.
Most probably, you can simple copy them over, and adjust some variables to your needs.
Actually, we also copied these files from the <a href="https://github.com/gardener/gardener-extension-shoot-networking-filter" target="_blank" rel="noopener noreferrer">gardener-extension-shoot-networking-filter</a> and adjusted them to the needs of the MWE.
Given that we have the boilerplate code in the <code>cmd</code> directory available now, we can go ahead and define a type which implements an <code>actuator</code> interface.
For this, we need the files in the <code>pkg</code> directory.
Lets take a look at the structure:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pkg</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└── controller</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	└── lifecycle</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">		├── actuator.go</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">		└── add.go</span><br></span></code></pre></div></div>
<p>Also here, we find only two files, and the implementation of the interface is located in <a href="https://github.com/23technologies/gardener-extension-mwe/blob/main/pkg/controller/lifecycle/actuator.go" target="_blank" rel="noopener noreferrer"><code>actuator.go</code></a>.
This is the place where most of the magic of your new controller happens.
In the case of the MWE, the actuator will only output logs, when <code>Extension</code> resources are reconciled.
Obviously, all code is written in Go and consequently we will also need to pull in some dependencies.
For this, we need the files <code>go.mod</code> and <code>go.sum</code>.
Typically, the source code of the dependencies is also committed to the repository, which comes at advantages and downsides.
The main advantage is that all code needed for building an application is available in the repository.
On the other hand, committing several 1000s lines of code during vendoring clutters the commit history of the repository.
Therefore, we only provide the files mentioned above in the <a href="https://github.com/23technologies/gardener-extension-mwe/commit/455c9c76876161bf8d5197e1330a9fc28f825baa" target="_blank" rel="noopener noreferrer">initial commit</a> of the MWE and perform the vendoring (by running <code>go mod vendor</code>) in <a href="https://github.com/23technologies/gardener-extension-mwe/commit/3c238bdcc5697392d567d5b6e5f2cf6126b3c756" target="_blank" rel="noopener noreferrer">another commit</a>.
At this state of the repository, we can already start and go the first steps with our new controller in a vanilla Kubernetes cluster.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="rapid-prototyping-on-a-kubernetes-cluster-tested-with-version-1226">Rapid prototyping on a Kubernetes cluster (tested with version 1.22.6)<a href="#rapid-prototyping-on-a-kubernetes-cluster-tested-with-version-1226" class="hash-link" aria-label="Direct link to Rapid prototyping on a Kubernetes cluster (tested with version 1.22.6)" title="Direct link to Rapid prototyping on a Kubernetes cluster (tested with version 1.22.6)">​</a></h3>
<p>Assuming you have read the <a href="#basic-workflows">basic workflows</a> section, we are ready to dive into the exemplary development techniques.
So let&#x27;s fetch the code and setup the repository:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">git clone https://github.com/23technologies/gardener-extension-mwe.git</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cd gardener-extension-mwe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git checkout 3c238bd  # checkout the commit containing first vendoring</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mkdir dev</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cp PATH-TO/KUBECONFIG.yaml dev/kubeconfig.yaml</span><br></span></code></pre></div></div>
<p>Now, we can already start our controller and should get some output showing that it was started:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">go run ./cmd/gardener-extension-mwe --kubeconfig=dev/kubeconfig.yaml  --ignore-operation-annotation=true --leader-election=false</span><br></span></code></pre></div></div>
<p>However, we will not observe any other output, since the controller is still freewheeling.
Remember, reconciliation will be triggered on <code>Extension</code> resources.
As our vanilla Kubernetes cluster does not know anything about <code>Extension</code> resources yet, we will have to &quot;fake&quot; the Gardener environment.
In other Gardener extensions, we find resources for a &quot;fake&quot; Gardener setup in the <code>example</code> directory.
Therefore, we prepared the <code>example</code> directory in <a href="https://github.com/23technologies/gardener-extension-mwe/commit/50f7136330e114ec2f795f3e30a756381dd4cbc6" target="_blank" rel="noopener noreferrer">another commit</a>.
Let&#x27;s check it out:
Open a new terminal pane and navigate to your repository and go for</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">git checkout 50f7136 # this commit entails the example directory</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export KUBECONFIG=dev/kubeconfig.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl apply -f example/10-fake-shoot-controlplane.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl apply -f example/20-crd-cluster.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl apply -f example/20-crd-extension.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl apply -f example/30-cluster.yaml</span><br></span></code></pre></div></div>
<p>Now, the cluster simulates a Gardener environment and we can apply an <code>Extension</code> resource:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl apply -f example/40-extension.yaml</span><br></span></code></pre></div></div>
<p>Take another look at the terminal running our controller now.
It should have logged a &quot;Hello World&quot; message.
Of course, we can also delete the <code>Extension</code> resource again and the controller will tell us that the <code>Delete</code> method was called.</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl delete -f example/40-extension.yaml</span><br></span></code></pre></div></div>
<p>As we have the code and a method to trigger its execution available now, we can go ahead for a more interactive approach based on the <a href="https://github.com/go-delve/delve" target="_blank" rel="noopener noreferrer">Delve debugger</a>.
Let&#x27;s start all over again and run our controller using Delve</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">dlv debug ./cmd/gardener-extension-mwe -- --kubeconfig=dev/kubeconfig.yaml  --ignore-operation-annotation=true --leader-election=false</span><br></span></code></pre></div></div>
<p>and we will end up in a commandline with a <code>(dlv)</code> prompt.
Next, we ask <code>dlv</code> to break in the <code>Reconcile</code> method</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(dlv) b github.com/23technologies/gardener-extension-mwe/pkg/controller/lifecycle.(*actuator).Reconcile</span><br></span></code></pre></div></div>
<p>and continue the execution of the controller</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(dlv) c</span><br></span></code></pre></div></div>
<p>Afterwards, you should observe some output of the controller, again.
However, Delve will not break the execution until the <code>Reconcile</code> method is called.
Thus, we apply the <code>Extension</code> resource once again</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl apply -f example/40-extension.yaml</span><br></span></code></pre></div></div>
<p>and Delve will stop in the <code>Reconcile</code> method.
Now, you can step through the code, see where it enters code paths pointing into the vendor directory, and inspect the values of certain variables.
Obviously, the amount of variables you can inspect is limited in the MWE, but e.g. we can have a look at the <code>*extensionsv1alpha1.Extension</code> passed to the <code>Reconcile</code> method</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(dlv) p ex.ObjectMeta.Name</span><br></span></code></pre></div></div>
<p>which should print <code>&quot;mwe&quot;</code>.
Generally, this is a great way to approach unknown software, since you will quickly get a feeling for the different components.
Thus, we expect that you can benefit from this workflow, when developing your own extensions.
Even though this approach offers capabilities for rapid prototyping, it is still limited, since we cannot act e.g. on <code>Shoot</code> clusters as available in a real world Gardener.
Therefore, we step into the development in a Gardener environment in the next section.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="development-in-a-real-gardener-environment">Development in a real Gardener environment<a href="#development-in-a-real-gardener-environment" class="hash-link" aria-label="Direct link to Development in a real Gardener environment" title="Direct link to Development in a real Gardener environment">​</a></h3>
<p>Developing and testing our extension in a real world Gardener requires a <code>ControllerRegistration</code> resource in the <code>Garden</code> cluster causing the installation of the controller in <code>Seed</code> clusters.
Generally, the installation performed by Helm charts and consequently, we need to provide these charts in the repository.
Also for the MWE, we prepared the <code>charts</code> directory containing all relevant Helmcharts for the deployment of the controller.
Note that this set of charts is very limited and in production scenarios you might want to add something like a <code>VerticalPodAutoscaler</code> as done e.g. in the <a href="https://github.com/gardener/gardener-extension-shoot-networking-filter" target="_blank" rel="noopener noreferrer">gardener-extension-shoot-networking-filter</a>.
However, implementing production ready charts goes beyond the scope of this post, and consequently the MWE charts were added in <a href="https://github.com/23technologies/gardener-extension-mwe/commit/beee274314ac628c65a3dcb4846dad577744b36a" target="_blank" rel="noopener noreferrer">another commit</a>.
These charts target at running the controller in <code>Seed</code> clusters.
Thus, in <code>charts/gardener-extension-mwe/values.yaml</code>, the image for the deployment is defined.
However, we do not want to push that image to a public container registry for each and every change we make to our code.
Moreover, we want to run the controller on our local machine for development purposes.
Therefore, we need to tweak the values before generating the <code>controller-registration.yaml</code>.
Let&#x27;s go through it step by step:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">git clone https://github.com/23technologies/gardener-extension-mwe.git</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cd gardener-extension-mwe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mkdir dev</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cp PATH-TO/KUBECONFIG-FOR-SEED.yaml dev/kubeconfig.yaml</span><br></span></code></pre></div></div>
<p>Next, we generate the <code>controller-registration.yaml</code>, such that the controller is not deployed to the seed cluster and we can hook-in the controller running locally.
In particular, we set <code>replicaCount=0</code> and <code>ignoreResources=true</code> in <code>./charts/gardener-extension-mwe/values.yaml</code>, before generating the <code>controller-registration.yaml</code>:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">yq eval -i &#x27;.replicaCount=0 | .ignoreResources=true&#x27; charts/gardener-extension-mwe/values.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./vendor/github.com/gardener/gardener/hack/generate-controller-registration.sh mwe charts/gardener-extension-mwe v0.0.1 example/controller-registration.yaml Extension:mwe</span><br></span></code></pre></div></div>
<p>Now, let&#x27;s deploy the generated <code>controller-registration.yaml</code> into the <code>Garden</code> cluster:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">export KUBECONFIG=PATH-TO/GARDEN-CLUSTER-KUBECONFIG.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl apply -f example/controller-registration.yaml</span><br></span></code></pre></div></div>
<p>From now on, <code>Extension</code> resources of the type <code>mwe</code> will be deployed to <code>Seed</code> clusters when new <code>Shoot</code> clusters with</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">---</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> core.gardener.cloud/v1beta1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Shoot</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> bar</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">namespace</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> garden</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">foo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">extensions</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> mwe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">...</span><br></span></code></pre></div></div>
<p>are created.
In our controller, the <code>Reconcile</code> method will be triggered, when these <code>Extension</code> resources are reconciled.
Therefore, we can run the extension controller with Delve now</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">dlv debug ./cmd/gardener-extension-mwe -- --kubeconfig=dev/kubeconfig.yaml  --ignore-operation-annotation=true --leader-election=false --gardener-version=&quot;v1.44.4&quot;</span><br></span></code></pre></div></div>
<p>and we can perform debugging operations as explained above.
Remember, Delve will not break the execution until the <code>Reconcile</code> method is called.
Now, Gardener will create <code>Extension</code> resources for <code>Shoot</code>s which will trigger the <code>Reconcile</code> method of our controller.
Consequently, we need a new terminal pane in the repository root and execute</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">export KUBECONFIG=PATH-TO/GARDEN-CLUSTER-KUBECONFIG.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl apply -f example/50-shoot.yaml</span><br></span></code></pre></div></div>
<p>Note that it will take some time until the corresponding <code>Extension</code> resource will be created in the <code>Seed</code> cluster.
Hang on tight and wait for the <code>Reconcile</code> method being executed.
You can start investigating where your code goes using Delve now.
Happy hacking!</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="last-words">Last words<a href="#last-words" class="hash-link" aria-label="Direct link to Last words" title="Direct link to Last words">​</a></h2>
<p>This blog post shares our experience, when getting started with Gardener extension development.
We hope that this contribution helps you get started more quickly than us.
If you have any comment or ideas for improvements, do not hesitate to contact us.
We are always willing to improve our work.</p></div><footer class="docusaurus-mt-lg"><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/blog/tags/gardener">gardener</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/blog/tags/gardener-extensions">gardener-extensions</a></li></ul></div></div><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class="col"><a href="https://github.com/yakecloud/yake/tree/main/docs/blog/2022-06-08-gardener-ext-dev.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/blog/gardener-chart-releaser"><div class="pagination-nav__sublabel">Newer post</div><div class="pagination-nav__label">A Single Point of Truth for Gardener Helm Charts</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/blog/gardener-ext-shoot-flux"><div class="pagination-nav__sublabel">Older post</div><div class="pagination-nav__label">A Gardener Extension for universal Shoot Configuration</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#tldr" class="table-of-contents__link toc-highlight">TLDR;</a></li><li><a href="#introduction" class="table-of-contents__link toc-highlight">Introduction</a></li><li><a href="#basic-workflows" class="table-of-contents__link toc-highlight">Basic workflows</a></li><li><a href="#the-mininal-working-example" class="table-of-contents__link toc-highlight">The mininal working example</a><ul><li><a href="#rapid-prototyping-on-a-kubernetes-cluster-tested-with-version-1226" class="table-of-contents__link toc-highlight">Rapid prototyping on a Kubernetes cluster (tested with version 1.22.6)</a></li><li><a href="#development-in-a-real-gardener-environment" class="table-of-contents__link toc-highlight">Development in a real Gardener environment</a></li></ul></li><li><a href="#last-words" class="table-of-contents__link toc-highlight">Last words</a></li></ul></div></div></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/overview">Docs</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/yakecloud" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://github.com/gardener-community" target="_blank" rel="noopener noreferrer" class="footer__link-item">Gardener Community<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://gardener-cloud.slack.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">Slack<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a class="footer__link-item" href="/legals">Legals</a></li><li class="footer__item"><a class="footer__link-item" href="/privacy-policy">Privacy policy</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 23 Technologies GmbH</div></div></div></footer></div>
</body>
</html>