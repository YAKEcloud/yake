apiVersion: v1
kind: ConfigMap
metadata:
  name: identity-base-values
  namespace: flux-system
data:
  values.yaml: |-
    connectors: ~
    issuerUrl: https://identity.{{ .Values.domains.global.domain }}/oidc
    dashboardOrigins:
      - 'https://dashboard.{{ .Values.domains.global.domain }}'
      - 'http://localhost:8000'
    dashboardClientSecret: {{ .Values.dashboard.clientSecret }}
    tls: ~
    ingress:
      annotations:
        nginx.ingress.kubernetes.io/ssl-redirect: "true"
        nginx.ingress.kubernetes.io/use-port-in-redirects: "true"
        kubernetes.io/ingress.class: nginx
        cert-manager.io/cluster-issuer: default-issuer
        dns.gardener.cloud/dnsnames: "*"
        dns.gardener.cloud/ttl: "600"
        dns.gardener.cloud/class: base-dns-class

{{ - if .Values.admin.staticPassword.enabled }}
    staticPasswords:
    - email: "{{ .Values.admin.email }}"
      # bcrypt hash of the string "password"
      hash: {{ .Values.admin.staticPassword.hash }}
      username: "admin"
      userID: {{ .Values.admin.staticPassword.userID }}
{{ - end }}
