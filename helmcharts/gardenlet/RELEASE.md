# [gardener/gardener]

## ‚ö†Ô∏è Breaking Changes

- `[OPERATOR]` All virtual garden access Secrets have to be labeled with with `resources.gardener.cloud/class=shoot`. Otherwise the virtual-GRM won't consider the Secrets and won't renew them. by @rfranzke [#8883]
- `[OPERATOR]` The `ContainerdRegistryHostsDir` feature gate has been promoted to beta and is now turned on by default. by @ialidzhikov [#8873]
- `[DEVELOPER]` Support for the deprecated `NetworkPolicy` annotations `networking.resources.gardener.cloud/from-policy-allowed-ports` and `networking.resources.gardener.cloud/from-policy-pod-label-selector` has been removed. Use `networking.resources.gardener.cloud/from-<some-alias>-allowed-ports` instead ([documentation](https://github.com/gardener/gardener/blob/master/docs/concepts/resource-manager.md#networkpolicy-controller)). by @rfranzke [#8883]
## üì∞ Noteworthy

- `[DEVELOPER]` The local Gardener environments for e2e tests running in Prow are now backed by the [`registry-cache`](https://github.com/gardener/gardener-extension-registry-cache/) extensions enabled in the Prow cluster. This should have a positive impact on the network I/O for image pulls and resulting costs. by @oliver-goetz [#8880]
- `[OPERATOR]` The `WorkerlessShoots` has been promoted to GA and is now locked to "enabled by default". by @acumino [#8906]
## ‚ú® New Features

- `[USER]` It is now possible to configure the resources encrypted in the ETCD for shoot clusters, see [this document](https://github.com/gardener/gardener/blob/master/docs/usage/etcd_encryption_config.md) for more details. by @shafeeqes [#8842]
- `[USER]` The `shoots/viewerkubeconfig` subresource now also restricts viewer access to resources which are specified in the `spec.kubernetes.kubeAPIServer.encryptionConfig` in the Shoot in addition to `Secrets`. by @shafeeqes [#8966]
- `[USER]` It is now possible to request a kubeconfig with read-only access (all APIs except `core/v1.Secret`) for shoot clusters by using the new `shoots/viewerkubeconfig` subresource. Read all about it [here](https://github.com/gardener/gardener/blob/master/docs/usage/shoot_access.md#shootsviewerkubeconfig-subresource). by @rfranzke [#8870]
- `[OPERATOR]` The `vpn-seed-server` component now supports IPv4 seed clusters hosting IPv6 shoot clusters.  by @DockToFuture [#8830]
- `[OPERATOR]` It is now possible to configure the resources encrypted in the ETCD for the virtual garden cluster, see [this document](https://github.com/gardener/gardener/blob/master/docs/concepts/operator.md#etcd-encryption-config) for more details. by @shafeeqes [#8842]
## üêõ Bug Fixes

- `[DEPENDENCY]` extension library: An issue causing the Worker restore operation to fail for hibernated Shoots is now fixed. by @ialidzhikov [#8943]
- `[OPERATOR]` A bug causing the Shoot to use the wrong istio load balancer if the `ExposureClass` name and the exposureclass handler name are not the same is now fixed.  by @shafeeqes [#8926]
- `[OPERATOR]` Fixed a bug where a Shoot with an expired machine image or Kubernetes version could be created.   
  For machine images: only allow updating to a higher expired machine image version for an existing worker pool  
  For Kubernetes versions: do not allow creation of a worker pool with an expired K8s version, but still allow updating an existing worker pool to a higher expired version. by @danielfoehrKn [#8854]
- `[OPERATOR]` `gardener-node-agent`'s `OperatingSystemConfig` controller now respects the reconciliation timeout and aborts the reconciliation if it takes too long. by @rfranzke [#8907]
- `[OPERATOR]` `gardener-node-agent` now creates temporary directories and files under `/var/lib/gardener-node-agent/tmp` instead of `/tmp`. This fixes issues during `OperatingSystemConfig` reconciliation which occur when `/var` and `/tmp` are backed by different file systems or devices. by @rfranzke [#8894]
- `[OPERATOR]` `gardener-node-agent` now skips disablement and stop attempts of deleted units in case their unit files have already been cleaned up by third parties. by @rfranzke [#8898]
- `[OPERATOR]` `gardener-node-agent` now converts the hostname to lower case to match `kubelet` behaviour when it maintains the `kubernetes.io/hostname` label on `Node`s. by @rfranzke [#8902]
## üèÉ Others

- `[OPERATOR]` `gardener-node-agent` now stops waiting for `systemd` command results if they don't respond back after `10s`. by @rfranzke [#8919]
- `[OPERATOR]` Add unhealthy nodes dashboard. by @adenitiu [#8869]
- `[OPERATOR]` Add `egressCIDRs` field to the infrastructureStatus resource. This allows provider-extensions to specify a list of stable CIDRs used as source IP for traffic generated by the shoot's worker nodes. by @kon-angelo [#8888]
- `[DEVELOPER]` Add support for optional `SCRIPT_ROOT` environment var in `vgopath` enabled hack scripts by @afritzler [#8935]
# [gardener/vpn2]

## ‚ö†Ô∏è Breaking Changes

- `[OPERATOR]` Change OCI Image Registry from GCR (`eu.gcr.io/gardener-project`) to Artifact-Registry (`europe-docker.pkg.dev/gardener-project/releases`). Users should update their references. by @ccwienk [gardener/vpn2#62]
## üì∞ Noteworthy

- `[OPERATOR]` added ipv6 single-stack support by @nschad [gardener/vpn2#45]
- `[OPERATOR]`  Add iptables backend detection to firewall script. by @axel7born [gardener/vpn2#64]
# [gardener/apiserver-proxy]

## üì∞ Noteworthy

- `[OPERATOR]` Remove the optional creation of iptables rules and the flag`--setup-iptables`. by @axel7born [gardener/apiserver-proxy#70]
# [gardener/gardener-metrics-exporter]

## üèÉ Others

- `[OPERATOR]` Metrics are exported for pending shoots as well. by @timebertt [gardener/gardener-metrics-exporter#91]

## Docker Images
- admission-controller: `eu.gcr.io/gardener-project/gardener/admission-controller:v1.86.0`
- apiserver: `eu.gcr.io/gardener-project/gardener/apiserver:v1.86.0`
- controller-manager: `eu.gcr.io/gardener-project/gardener/controller-manager:v1.86.0`
- gardenlet: `eu.gcr.io/gardener-project/gardener/gardenlet:v1.86.0`
- node-agent: `eu.gcr.io/gardener-project/gardener/node-agent:v1.86.0`
- operator: `eu.gcr.io/gardener-project/gardener/operator:v1.86.0`
- resource-manager: `eu.gcr.io/gardener-project/gardener/resource-manager:v1.86.0`
- scheduler: `eu.gcr.io/gardener-project/gardener/scheduler:v1.86.0`