# [gardener-extension-provider-aws]
## âš ï¸ Breaking Changes
* *[USER]* The default VolumeSnapshotClass managed by `provider-aws` does now properly define this VolumeSnapshotClass as default one. Previously there was a typo in the annotation value for `snapshot.storage.kubernetes.io/is-default-class`, hence the VolumeSnapshotClass was never considered as default one by the external-snapshotter and the VolumeSnapshotClass defaulting was never working as expected. ([gardener/gardener-extension-provider-aws#723](https://github.com/gardener/gardener-extension-provider-aws/pull/723), [@ialidzhikov](https://github.com/ialidzhikov))
  * If you already deploy your own default VolumeSnapshotClass, then consider disabling provider-aws's default VolumeSnapshotClass (using the `storage.managedDefaultClass` field in the controlPlaneConfig) as having more than 1 default VolumeSnapshotClass will prevent external-snapshotter to default the `spec.volumeSnapshotClassName` of a VolumeSnapshot.
## âœ¨ New Features
* *[OPERATOR]* The `csi-snapshot-validation` Service deployed by the provider-aws extension and the provider-aws's `gardener-extension-provider-aws` Service can now be topology-aware (depending on the Seed setting and the Shoot HA failure tolerance type). For more details, see the [Topology-aware Traffic Routing documentation](https://github.com/gardener/gardener/blob/v1.66.0/docs/usage/topology_aware_routing.md). ([gardener/gardener-extension-provider-aws#703](https://github.com/gardener/gardener-extension-provider-aws/pull/703), [@ialidzhikov](https://github.com/ialidzhikov))
* *[OPERATOR]* `csi-driver-node` is annotated with the `wait-for-csi-node` annotation. Gardener uses this to only schedule workload pods to a `Node` once the driver has been successfully registered with the `CSINode` object. ([gardener/gardener-extension-provider-aws#716](https://github.com/gardener/gardener-extension-provider-aws/pull/716), [@SimonKienzler](https://github.com/SimonKienzler))
## ðŸ› Bug Fixes
* *[OPERATOR]* Fix an issue where `shoot` reconciliation would fail when `sshAccess` was disabled. ([gardener/gardener-extension-provider-aws#704](https://github.com/gardener/gardener-extension-provider-aws/pull/704), [@AleksandarSavchev](https://github.com/AleksandarSavchev))
* *[OPERATOR]* The stale healthcheck conditions from the extension are now properly cleaned up. ([gardener/gardener-extension-provider-aws#724](https://github.com/gardener/gardener-extension-provider-aws/pull/724), [@acumino](https://github.com/acumino))
* *[OPERATOR]* An issue has been fixed which caused undesired `PATCH` requests when updating the state in the `Worker` or `ShootState` resources. ([gardener/gardener-extension-provider-aws#729](https://github.com/gardener/gardener-extension-provider-aws/pull/729), [@oliver-goetz](https://github.com/oliver-goetz))
* *[OPERATOR]* An issue causing provider-aws to wrongly delete the `extensions.gardener.cloud:provider-aws:csi-snapshot-validation` ClusterRole and ClusterRoleBinding from the Seed cluster on every Shoot deletion is now fixed. ([gardener/gardener-extension-provider-aws#735](https://github.com/gardener/gardener-extension-provider-aws/pull/735), [@ialidzhikov](https://github.com/ialidzhikov))
## ðŸƒ Others
* *[OPERATOR]* Added `cloudprovider` webhook part of `gardener-extension-provider-aws` which ensures that the `cloudprovider` secret has the `credentialsFile` field present. The format of this field can be found in [this documentation](https://docs.aws.amazon.com/sdkref/latest/guide/file-format.html). ([gardener/gardener-extension-provider-aws#683](https://github.com/gardener/gardener-extension-provider-aws/pull/683), [@AleksandarSavchev](https://github.com/AleksandarSavchev))
* *[OPERATOR]* The `cloud-controler-manager` and `csi-driver-controller` deployments now use an AWS credentials file for authentication. ([gardener/gardener-extension-provider-aws#683](https://github.com/gardener/gardener-extension-provider-aws/pull/683), [@AleksandarSavchev](https://github.com/AleksandarSavchev))
* *[OPERATOR]* Add support for IMDSv2 ([gardener/gardener-extension-provider-aws#709](https://github.com/gardener/gardener-extension-provider-aws/pull/709), [@kon-angelo](https://github.com/kon-angelo))
* *[OPERATOR]* Adapted extension components to support the [FullNetworkPoliciesInRuntimeCluster](https://github.com/gardener/gardener/blob/master/docs/deployment/feature_gates.md#list-of-feature-gates) feature gate introduced by `gardener/gardener` v1.66, see [here](https://github.com/gardener/gardener/blob/master/docs/concepts/resource-manager.md#networkpolicy-controller) and [#7352](https://github.com/gardener/gardener/pull/7589) for more information. ([gardener/gardener-extension-provider-aws#714](https://github.com/gardener/gardener-extension-provider-aws/pull/714), [@rfranzke](https://github.com/rfranzke))
* *[OPERATOR]* aws-ebs-csi-driver has been updated `v1.14.1 -> v1.17.0` ([gardener/gardener-extension-provider-aws#721](https://github.com/gardener/gardener-extension-provider-aws/pull/721), [@kon-angelo](https://github.com/kon-angelo))
* *[OPERATOR]* cloud-controller-manager has been updated `v1.26.0 -> v1.26.1` ([gardener/gardener-extension-provider-aws#721](https://github.com/gardener/gardener-extension-provider-aws/pull/721), [@kon-angelo](https://github.com/kon-angelo))
* *[OPERATOR]* Fix an issue that allows duplicate zones in the infrastructure. ([gardener/gardener-extension-provider-aws#726](https://github.com/gardener/gardener-extension-provider-aws/pull/726), [@kon-angelo](https://github.com/kon-angelo))
* *[OPERATOR]* The `gardener-extension-admission-aws` Service in the `gardener-extension-admission-aws` chart can now be configured to be topology-aware. ([gardener/gardener-extension-provider-aws#732](https://github.com/gardener/gardener-extension-provider-aws/pull/732), [@ialidzhikov](https://github.com/ialidzhikov))
# [aws-custom-route-controller]
## ðŸƒ Others
* *[OPERATOR]* Bump golang.org/x/net from 0.2.0 to 0.7.0 ([gardener/aws-custom-route-controller#10](https://github.com/gardener/aws-custom-route-controller/pull/10), [@dependabot[bot]](https://github.com/dependabot[bot]))
* *[OPERATOR]* Bump builder image from `golang:1.19.5` to `golang:1.20.2` ([gardener/aws-custom-route-controller#11](https://github.com/gardener/aws-custom-route-controller/pull/11), [@MartinWeindel](https://github.com/MartinWeindel))
# [machine-controller-manager]
## ðŸ› Bug Fixes
* *[USER]* An edge case where all the machineSets were scaled down to zero has been dealt with. ([gardener/machine-controller-manager#804](https://github.com/gardener/machine-controller-manager/pull/804), [@himanshu-kun](https://github.com/himanshu-kun))
# [machine-controller-manager-provider-aws]
## âš ï¸ Breaking Changes
* *[DEPENDENCY]* `KeyName` in `AWSProviderSpec` struct has been changed to a `pointer`. ([gardener/machine-controller-manager-provider-aws#104](https://github.com/gardener/machine-controller-manager-provider-aws/pull/104), [@AleksandarSavchev](https://github.com/AleksandarSavchev))
## âœ¨ New Features
* *[OPERATOR]* added support to modify instance metadata parameters for a VM through machineClass only during creation. This could be used to enable instance metadatav2 to containerised environment ([gardener/machine-controller-manager-provider-aws#105](https://github.com/gardener/machine-controller-manager-provider-aws/pull/105), [@kon-angelo](https://github.com/kon-angelo))
## ðŸƒ Others
* *[OPERATOR]* Dropped validation for `KeyName` in `AWSProviderSpec`. ([gardener/machine-controller-manager-provider-aws#104](https://github.com/gardener/machine-controller-manager-provider-aws/pull/104), [@AleksandarSavchev](https://github.com/AleksandarSavchev))
* *[OPERATOR]* CVE categorization for mcm-provider-aws has been added. ([gardener/machine-controller-manager-provider-aws#108](https://github.com/gardener/machine-controller-manager-provider-aws/pull/108), [@dkistner](https://github.com/dkistner))
# [terraformer]
## ðŸƒ Others
* *[OPERATOR]* Update TF_VERSION `0.15.5` -> `1.3.9` and update how the local providers are fetched and stored to be compatible with the latest TF specification. ([gardener/terraformer#133](https://github.com/gardener/terraformer/pull/133), [@kon-angelo](https://github.com/kon-angelo))