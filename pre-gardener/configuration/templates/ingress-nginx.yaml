apiVersion: v1
kind: Secret
metadata:
  name: ingress-nginx-base-values
  namespace: flux-system
type: Opaque
stringData:
  values.yaml: |-
    controller:
{{- if .Values.registryOverwrite }}
      image:
        registry: {{ include "replaceRegistry" (dict "registry.k8s.io" .Values.registryOverwrite) }}
        image: ingress-nginx/controller #!!!!!!!!!!!!!
{{- end }}
      podLabels:
        app: nginx-ingress
        component: controller
      service:
        annotations:
{{- if .Values.issuer.enabled }}
          cert.gardener.cloud/class: base-cert-class
          cert.gardener.cloud/secretname: controlplane-cert-secret
{{- end }}
          dns.gardener.cloud/dnsnames: "*.{{ include "gardenlet.ingressDomain" . }}"
          dns.gardener.cloud/ttl: "600"
          dns.gardener.cloud/class: base-dns-class
      extraArgs:
        enable-ssl-passthrough: ""
{{- if .Values.issuer.enabled }}
---
apiVersion: v1
kind: Secret
metadata:
  labels:
    gardener.cloud/role: controlplane-cert
  name: controlplane-cert-secret
  namespace: garden
type: Opaque
{{- end }}
